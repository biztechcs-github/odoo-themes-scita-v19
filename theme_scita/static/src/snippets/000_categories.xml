<?xml version="1.0" encoding="UTF-8"?>
<templates xml:space="preserve">

    <t t-inherit="website.s_searchbar.autocomplete" t-inherit-mode="extension">
        <xpath expr="//a[@t-foreach='results']" position="replace">
            <div class="d-flex flex-wrap">
                    <t t-if="results and results.filter(r => r['is_combo']).length">
                <div class="p-3 border-end searchbar_cat_left">
                    <h6 class="fw-bold mb-3"><i class="fa fa-dot-circle-o text-purple me-1"></i> Your search:</h6>
                    <div class="d-flex flex-column gap-2">
                        <t t-foreach="results or []" t-as="result" t-key="result['name']">
                            <t t-if="result['is_combo']">
                                <a t-att-href="result['website_url']" class="badge bg-light text-dark px-3 py-2 search_chip text-decoration-none d-block">
                                    <i class="fa fa-search me-2" aria-hidden="true"></i>
                                    <t t-out="result['name']"/>
                                </a>
                            </t>
                        </t>
                    </div>
                </div>
            </t>
                <div class="w-100 searchbar_cat_right">
                   <div class="p-3">
                        <!-- Categories Section -->
                        <t t-if="results.filter(r => r['category']).length">
                            <div class="mb-2 fw-bold text-purple">
                                <i class="fa fa-dot-circle-o text-purple me-1"></i> Categories:
                            </div>
                            <div class="d-flex flex-wrap gap-2">
                                <t t-foreach="results" t-as="result" t-key="result['name'] + '_cat'">
                                    <t t-if="result['category']">
                                        <a t-att-href="result['website_url']" class="chip-link text-decoration-none" t-if="result['category']">
                                            <span class="chip">
                                            <t t-if="result['image']">
                                                <img t-att-src="result['image']" class=""/>
                                            </t>
                                                <div class="d-flex align-items-center flex-wrap o_search_result_item">
                                                    <div class="o_search_result_item_detail px-3">
                                                        <t t-set="description" t-value="parts['description'] and widget.displayDescription and result['description']"/>
                                                        <t t-set="extra_link" t-value="parts['extra_link'] and widget.displayExtraLink and result['extra_link_url'] and result['extra_link']"/>
                                                        <t t-set="extra_link_html" t-value="parts['extra_link'] and widget.displayExtraLink and !result['extra_link_url'] and result['extra_link']"/>
                                                        <div t-attf-class="h6 fw-bold #{description ? '' : 'mb-0'}" t-out="result['name']"/>
                                                        <button t-if="extra_link" class="extra_link btn btn-link btn-sm" t-att-data-target="result['extra_link_url']" t-out="extra_link"/>
                                                    </div>
                                                    <div t-if="parts['detail'] and widget.displayDetail" class="flex-shrink-0 ms-auto pro_price">
                                                        <t t-if="result['detail_strike']">
                                                            <span class="text-muted text-nowrap">
                                                                <t t-out="result['detail_strike']"/>
                                                            </span>
                                                            <br/>
                                                        </t>
                                                        <b t-if="result['detail']" class="text-nowrap">
                                                            <t t-out="result['detail']"/>
                                                        </b>
                                                        <t t-if="result['detail_extra']">
                                                            <br/>
                                                            <span class="text-nowrap" t-out="result['detail_extra']"/>
                                                        </t>
                                                    </div>
                                                </div>
                                            </span>
                                        </a>        
                                    </t>
                                </t>
                            </div>
                        </t>
                        <!-- Brands Section -->
                        <t t-if="results.filter(r => r['brand']).length">
                            <div class="mb-2 fw-bold text-primary">
                                <i class="fa fa-dot-circle-o text-primary me-1"></i> Brands:
                            </div>
                            <div class="d-flex flex-wrap gap-2 mb-3">
                                <t t-foreach="results" t-as="result" t-key="result['name'] + '_brand'">
                                    <t t-if="result['brand']">
                                        <a t-att-href="result['website_url']" class="chip-link text-decoration-none">
                                            <span class="chip">
                                                <div class="d-flex align-items-center flex-wrap o_search_result_item">
                                                    <t t-if="result['image']">
                                                        <img t-att-src="result['image']" class="me-2"/>
                                                    </t>
                                                    <div class="o_search_result_item_detail px-3">
                                                        <div class="h6 fw-bold text-primary" t-out="result['name']"/>
                                                    </div>
                                                </div>
                                            </span>
                                        </a>
                                    </t>
                                </t>
                            </div>
                        </t>
                    </div>
                    <hr t-if="results.length"/>
                    <div class="p-3">
                        <t t-foreach="results" t-as="result" t-key="result_index">
                            <t t-if="!result['is_combo'] and !result['brand']">
                                <a t-att-href="result['website_url']" class="dropdown-item p-2 text-wrap" t-if="!result['category']">
                                    <div class="d-flex align-items-center flex-wrap o_search_result_item">
                                        <t t-if="widget.displayImage">
                                            <img t-if="result['image_url']" t-att-src="result['image_url']" class="flex-shrink-0 o_image_64_contain"/>
                                            <i t-else="" t-attf-class="o_image_64_contain text-center pt16 fa #{result['_fa']}" style="font-size: 34px;"/>
                                        </t>
                                        <div class="o_search_result_item_detail px-3">
                                            <t t-set="description" t-value="parts['description'] and widget.displayDescription and result['description']"/>
                                            <t t-set="extra_link" t-value="parts['extra_link'] and widget.displayExtraLink and result['extra_link_url'] and result['extra_link']"/>
                                            <t t-set="extra_link_html" t-value="parts['extra_link'] and widget.displayExtraLink and !result['extra_link_url'] and result['extra_link']"/>
                                            <div t-attf-class="h6 fw-bold #{description ? '' : 'mb-0'}" t-out="result['name']"/>
                                            <p t-if="description" class="mb-0" t-out="description"/>
                                            <button t-if="extra_link" class="extra_link btn btn-link btn-sm" t-att-data-target="result['extra_link_url']" t-out="extra_link"/>
                                        </div>
                                        <div t-if="parts['detail'] and widget.displayDetail" class="flex-shrink-0 ms-auto pro_price">
                                            <t t-if="result['detail_strike']">
                                                <span class="text-muted text-nowrap" style="text-decoration: line-through;">
                                                    <t t-out="result['detail_strike']"/>
                                                </span>
                                                <br/>
                                            </t>
                                            <b t-if="result['detail']" class="text-nowrap">
                                                <t t-out="result['detail']"/>
                                            </b>
                                            <t t-if="result['detail_extra']">
                                                <br/>
                                                <span class="text-nowrap" t-out="result['detail_extra']"/>
                                            </t>
                                        </div>
                                    </div>
                                </a>
                            </t>
                        </t>
                    </div>
                </div>
            </div>
        </xpath>
    </t>
</templates>