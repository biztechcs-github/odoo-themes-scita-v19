<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <template id="varient_color_on_shop" inherit_id="website_sale.products_item">
        <!-- <xpath expr="//div[hasclass('o_wsale_product_btn')]" position="before">
            <div id="threshold_message_scita" t-if="product.show_availability and prod_available[product.id]['free_qty'] &lt;= product.available_threshold and prod_available[product.id]['free_qty'] != 0" t-attf-class="availability_message_#{product.id} text-warning fw-bold">
                <t t-esc="prod_available[product.id]['free_qty']"/> <t t-esc="product.uom_name" /> left
            </div>
            <div id="threshold_message_scita_out_of_stock" t-if="product.show_availability and prod_available[product.id]['free_qty'] &lt;= 0" t-attf-class="out_of_stock_message_#{product.id} text-warning fw-bold">
                <t>OUT OF STOCK</t>
            </div>
        </xpath> -->
        <xpath expr="//div[hasclass('o_wsale_product_btn')]" position="before">
            <t t-foreach="product.valid_product_template_attribute_line_ids" t-as="ptal">
                <t t-if="ptal.attribute_id.display_type == 'color'">
                    <ul t-att-data-attribute_id="ptal.attribute_id.id" t-attf-class="list-inline o_wsale_product_attribute scita_attribute_select d-none d-xl-flex"
                        t-attf-data-default-img-src="/web/image/product.template/#{product.id}/image_512"
                        >
                        <t t-set="product_attr_values" t-value="ptal.product_template_value_ids._only_active()"/>
                        <li t-foreach="product_attr_values[:4]" t-as="ptav" class="list-inline-item me-1 scita_attribute_li">
                            <t t-set="product_product" t-value="product._get_product_variant(ptav)"></t>
                            <t t-if="product_product">
                                <t t-set="img_style" t-value="'background-image:url(/web/image/product.template.attribute.value/%s/image); background-size:cover;' % ptav.id if ptav.image else ''"/>
                                <t t-set="color_style" t-value="'background-color:' + str(ptav.html_color or ptav.product_attribute_value_id.name if not ptav.is_custom else '')"/>
                                <t t-set="variant_url" t-value="product.website_url + '#attribute_values=' + str(ptav.product_attribute_value_id.id)"/>
                                <t t-set="variant_img" t-value="'/web/image/product.product/%s/image_512' % product_product[0]"/>
                                <a t-att-href="variant_url"
                                    t-attf-style="#{img_style or color_style}"
                                    t-attf-class="css_attribute_color d-block"
                                    t-att-title="ptav.name"
                                    t-att-data-preview-img-src="variant_img"
                                    />
                            </t>
                        </li>
                        <li t-if="len(product_attr_values) > 4">
                            <a class="link-dark d-flex align-items-center h-100 w-100"
                            t-att-href="product.website_url">+
                                <t t-out="len(product_attr_values) - 4"/>
                            </a>
                        </li>
                    </ul>
                    <ul t-att-data-attribute_id="ptal.attribute_id.id" t-attf-class="list-inline o_wsale_product_attribute scita_attribute_select d-flex d-xl-none"
                        t-attf-data-default-img-src="/web/image/product.template/#{product.id}/image_512"
                        >
                        <t t-set="product_attr_values" t-value="ptal.product_template_value_ids._only_active()"/>
                        <li t-foreach="product_attr_values[:2]" t-as="ptav" class="list-inline-item me-1 scita_attribute_li">
                            <t t-set="product_product" t-value="product._get_product_variant(ptav)"></t>
                            <t t-if="product_product">
                                <t t-set="img_style" t-value="'background-image:url(/web/image/product.template.attribute.value/%s/image); background-size:cover;' % ptav.id if ptav.image else ''"/>
                                <t t-set="color_style" t-value="'background-color:' + str(ptav.html_color or ptav.product_attribute_value_id.name if not ptav.is_custom else '')"/>
                                <t t-set="variant_url" t-value="product.website_url + '#attribute_values=' + str(ptav.product_attribute_value_id.id)"/>
                                <t t-set="variant_img" t-value="'/web/image/product.product/%s/image_512' % product_product[0]"/>
                                <a t-att-href="variant_url"
                                    t-attf-style="#{img_style or color_style}"
                                    t-attf-class="css_attribute_color d-block"
                                    t-att-title="ptav.name"
                                    t-att-data-preview-img-src="variant_img"
                                    />
                            </t>
                        </li>
                        <li t-if="len(product_attr_values) > 2">
                            <a class="link-dark d-flex align-items-center h-100 w-100"
                            t-att-href="product.website_url">+
                                <t t-out="len(product_attr_values) - 2"/>
                            </a>
                        </li>
                    </ul>
                </t>
            </t>
        </xpath>
    </template>
</odoo>